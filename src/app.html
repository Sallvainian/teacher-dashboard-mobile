<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>Teacher Dashboard - Educational Management System</title>
		<meta name="description" content="Educational classroom management tool for teachers to track student progress, assignments, and grades. Built for K-12 education.">
		<meta name="keywords" content="education, classroom management, teacher tools, student progress, gradebook, assignments, K-12, academic">
		<meta name="robots" content="index, follow">
		<meta property="og:title" content="Teacher Dashboard - Educational Management System">
		<meta property="og:description" content="Professional classroom management tool for educators">
		<meta property="og:type" content="website">
		<link rel="icon" href="%sveltekit.assets%/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div class="sveltekit-body">%sveltekit.body%</div>
		<script nonce="%sveltekit.nonce%">
			// Initialize theme immediately to prevent flash
			const savedMode = localStorage.getItem('theme-mode') || 'auto';
			const savedAccent = localStorage.getItem('theme-accent') || 'blue';
			
			// Accent color presets
			const colors = {
				blue: { primary: '#3b82f6', light: '#93c5fd', hover: '#2563eb', bg: 'rgba(59, 130, 246, 0.1)', glow: 'rgba(59, 130, 246, 0.2)' },
				purple: { primary: '#8b5cf6', light: '#c4b5fd', hover: '#7c3aed', bg: 'rgba(139, 92, 246, 0.1)', glow: 'rgba(139, 92, 246, 0.2)' },
				green: { primary: '#10b981', light: '#6ee7b7', hover: '#059669', bg: 'rgba(16, 185, 129, 0.1)', glow: 'rgba(16, 185, 129, 0.2)' },
				orange: { primary: '#f97316', light: '#fdba74', hover: '#ea580c', bg: 'rgba(249, 115, 22, 0.1)', glow: 'rgba(249, 115, 22, 0.2)' },
				pink: { primary: '#ec4899', light: '#f9a8d4', hover: '#db2777', bg: 'rgba(236, 72, 153, 0.1)', glow: 'rgba(236, 72, 153, 0.2)' },
				teal: { primary: '#14b8a6', light: '#5eead4', hover: '#0d9488', bg: 'rgba(20, 184, 166, 0.1)', glow: 'rgba(20, 184, 166, 0.2)' },
				red: { primary: '#ef4444', light: '#fca5a5', hover: '#dc2626', bg: 'rgba(239, 68, 68, 0.1)', glow: 'rgba(239, 68, 68, 0.2)' },
				indigo: { primary: '#6366f1', light: '#a5b4fc', hover: '#4f46e5', bg: 'rgba(99, 102, 241, 0.1)', glow: 'rgba(99, 102, 241, 0.2)' }
			};
			
			// Apply accent color
			const accentColor = colors[savedAccent] || colors.blue;
			const root = document.documentElement;
			root.style.setProperty('--purple', accentColor.primary);
			root.style.setProperty('--purple-light', accentColor.light);
			root.style.setProperty('--purple-hover', accentColor.hover);
			root.style.setProperty('--purple-bg', accentColor.bg);
			root.style.setProperty('--shadow-glow', `0 0 15px ${accentColor.glow}`);
			
			// Apply theme mode
			const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
			const shouldUseDark = savedMode === 'dark' || (savedMode === 'auto' && prefersDark);
			
			if (shouldUseDark) {
				root.classList.add('dark');
				root.setAttribute('data-theme', 'dark');
			} else {
				root.classList.remove('dark');
				root.setAttribute('data-theme', 'light');
			}
			
			// Force reload if we detect cache mismatch (old JS files)
			window.addEventListener('error', function(e) {
				// Check if error is from missing JS files (cache mismatch)
				if (e.filename && e.filename.includes('_app/immutable/') && e.message.includes('404')) {
					console.log('ðŸ”„ Cache mismatch detected, forcing reload...');
					// Clear all caches and reload
					if ('caches' in window) {
						caches.keys().then(function(cacheNames) {
							return Promise.all(cacheNames.map(cacheName => caches.delete(cacheName)));
						}).then(function() {
							window.location.reload(true);
						});
					} else {
						window.location.reload(true);
					}
				}
			});
			
			// Clean up any old service workers (one-time cleanup)
			if ('serviceWorker' in navigator) {
				navigator.serviceWorker.getRegistrations().then(function(registrations) {
					if (registrations.length > 0) {
						console.log('ðŸ§¹ Cleaning up', registrations.length, 'old service workers');
						for(let registration of registrations) {
							registration.unregister();
						}
					}
				});
				
				// Clean up old caches
				if ('caches' in window) {
					caches.keys().then(function(cacheNames) {
						if (cacheNames.length > 0) {
							console.log('ðŸ§¹ Cleaning up', cacheNames.length, 'old caches');
							return Promise.all(cacheNames.map(cacheName => caches.delete(cacheName)));
						}
					});
				}
			}
		</script>
	</body>
</html>